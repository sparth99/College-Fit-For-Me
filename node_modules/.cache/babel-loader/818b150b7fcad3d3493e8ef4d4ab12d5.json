{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _createReactClass = require('create-react-class');\n\nvar _createReactClass2 = _interopRequireDefault(_createReactClass);\n\nvar _Chart = require('./Chart');\n\nvar _Chart2 = _interopRequireDefault(_Chart);\n\nvar _Bar = require('./Bar');\n\nvar _Bar2 = _interopRequireDefault(_Bar);\n\nvar _DefaultPropsMixin = require('./DefaultPropsMixin');\n\nvar _DefaultPropsMixin2 = _interopRequireDefault(_DefaultPropsMixin);\n\nvar _HeightWidthMixin = require('./HeightWidthMixin');\n\nvar _HeightWidthMixin2 = _interopRequireDefault(_HeightWidthMixin);\n\nvar _ArrayifyMixin = require('./ArrayifyMixin');\n\nvar _ArrayifyMixin2 = _interopRequireDefault(_ArrayifyMixin);\n\nvar _StackAccessorMixin = require('./StackAccessorMixin');\n\nvar _StackAccessorMixin2 = _interopRequireDefault(_StackAccessorMixin);\n\nvar _StackDataMixin = require('./StackDataMixin');\n\nvar _StackDataMixin2 = _interopRequireDefault(_StackDataMixin);\n\nvar _DefaultScalesMixin = require('./DefaultScalesMixin');\n\nvar _DefaultScalesMixin2 = _interopRequireDefault(_DefaultScalesMixin);\n\nvar _TooltipMixin = require('./TooltipMixin');\n\nvar _TooltipMixin2 = _interopRequireDefault(_TooltipMixin);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar array = _propTypes2.default.array,\n    func = _propTypes2.default.func; // receive array and return a subsampled array of size n\n//\n// a= the array;\n// n= number of sample you want output\n\nvar subSample = function subSample(a, n) {\n  var returnArray = [];\n  var m = a.length;\n  var samplingRatio = m / n; //just round down for now in case of comma separated\n\n  for (var i = 0; i < m;) {\n    returnArray.push(a[Math.floor(i)]);\n    i += samplingRatio;\n  }\n\n  return returnArray;\n};\n\nvar DataSet = (0, _createReactClass2.default)({\n  displayName: 'DataSet',\n  propTypes: {\n    data: array.isRequired,\n    xScale: func.isRequired,\n    yScale: func.isRequired,\n    colorScale: func.isRequired,\n    values: func.isRequired,\n    label: func.isRequired,\n    x: func.isRequired,\n    y: func.isRequired,\n    y0: func.isRequired\n  },\n  render: function render() {\n    var _props = this.props,\n        data = _props.data,\n        yScale = _props.yScale,\n        colorScale = _props.colorScale,\n        values = _props.values,\n        label = _props.label,\n        y = _props.y,\n        x0 = _props.x0,\n        onMouseEnter = _props.onMouseEnter,\n        onMouseLeave = _props.onMouseLeave;\n    var height = yScale(yScale.domain()[0]);\n    var bars = data.map(function (stack) {\n      return values(stack).map(function (e, index) {\n        // maps the range [0,1] to the range [0, yDomain]\n        var yValue = height * y(e); // center vertically to have upper and lower part of the waveform\n\n        var vy = height / 2 - yValue / 2; //position x(e) * width * 2 because we want equal sapce.\n\n        var vx = 2 * x0 * index;\n        return _react2.default.createElement(_Bar2.default, {\n          key: label(stack) + '.' + index,\n          width: x0,\n          height: yValue,\n          x: vx,\n          y: vy,\n          fill: colorScale(Math.floor(vx)),\n          data: e,\n          onMouseEnter: onMouseEnter,\n          onMouseLeave: onMouseLeave\n        });\n      });\n    });\n    return _react2.default.createElement('g', null, bars);\n  }\n});\nvar Waveform = (0, _createReactClass2.default)({\n  displayName: 'Waveform',\n  mixins: [_DefaultPropsMixin2.default, _HeightWidthMixin2.default, _ArrayifyMixin2.default, _StackAccessorMixin2.default, _StackDataMixin2.default, _DefaultScalesMixin2.default, _TooltipMixin2.default],\n  getDefaultProps: function getDefaultProps() {\n    return {};\n  },\n  _tooltipHtml: function _tooltipHtml(d) {\n    var _ref = [this._xScale, this._yScale],\n        xScale = _ref[0],\n        yScale = _ref[1];\n    var html = this.props.tooltipHtml(this.props.x(d), this.props.y0(d), this.props.y(d));\n    var midPoint = xScale.rangeBand() / 2;\n    var xPos = midPoint + xScale(this.props.x(d));\n    var topStack = this._data[this._data.length - 1].values;\n    var topElement = null; // TODO: this might not scale if dataset is huge.\n    // consider pre-computing yPos for each X\n\n    for (var i = 0; i < topStack.length; i++) {\n      if (this.props.x(topStack[i]) === this.props.x(d)) {\n        topElement = topStack[i];\n        break;\n      }\n    }\n\n    var yPos = yScale(this.props.y0(topElement) + this.props.y(topElement));\n    return [html, xPos, yPos];\n  },\n  render: function render() {\n    var _props2 = this.props,\n        height = _props2.height,\n        width = _props2.width,\n        margin = _props2.margin,\n        colorScale = _props2.colorScale,\n        values = _props2.values,\n        label = _props2.label,\n        y = _props2.y,\n        y0 = _props2.y0,\n        x = _props2.x;\n    var data = this._data;\n    var innerWidth = this._innerWidth;\n    var xScale = this._xScale;\n    var yScale = this._yScale;\n    var preserveAspectRatio = 'none';\n    var viewBox = '0 0 ' + width + ' ' + height; // there are two options, if the samples are less than the space available\n    // we'll stretch the width of bar and inbetween spaces.\n    // Otherwise we just subSample the dataArray.\n\n    var barWidth = void 0;\n\n    if (data[0].values.length > innerWidth / 2) {\n      data[0].values = subSample(data[0].values, innerWidth / 2);\n      barWidth = 1;\n    } else {\n      barWidth = innerWidth / 2 / data[0].values.length;\n    }\n\n    return _react2.default.createElement('div', null, _react2.default.createElement(_Chart2.default, {\n      height: height,\n      width: width,\n      margin: margin,\n      viewBox: viewBox,\n      preserveAspectRatio: preserveAspectRatio\n    }, _react2.default.createElement(DataSet, {\n      data: data,\n      xScale: xScale,\n      yScale: yScale,\n      colorScale: colorScale,\n      label: label,\n      values: values,\n      x: x,\n      y: y,\n      y0: y0,\n      x0: barWidth,\n      onMouseEnter: this.onMouseEnter,\n      onMouseLeave: this.onMouseLeave\n    }, this.props.children)));\n  }\n});\nexports.default = Waveform;","map":{"version":3,"sources":["/Users/Parth/web-project/node_modules/react-d3-components/lib/Waveform.js"],"names":["Object","defineProperty","exports","value","_react","require","_react2","_interopRequireDefault","_propTypes","_propTypes2","_createReactClass","_createReactClass2","_Chart","_Chart2","_Bar","_Bar2","_DefaultPropsMixin","_DefaultPropsMixin2","_HeightWidthMixin","_HeightWidthMixin2","_ArrayifyMixin","_ArrayifyMixin2","_StackAccessorMixin","_StackAccessorMixin2","_StackDataMixin","_StackDataMixin2","_DefaultScalesMixin","_DefaultScalesMixin2","_TooltipMixin","_TooltipMixin2","obj","__esModule","default","array","func","subSample","a","n","returnArray","m","length","samplingRatio","i","push","Math","floor","DataSet","displayName","propTypes","data","isRequired","xScale","yScale","colorScale","values","label","x","y","y0","render","_props","props","x0","onMouseEnter","onMouseLeave","height","domain","bars","map","stack","e","index","yValue","vy","vx","createElement","key","width","fill","Waveform","mixins","getDefaultProps","_tooltipHtml","d","_ref","_xScale","_yScale","html","tooltipHtml","midPoint","rangeBand","xPos","topStack","_data","topElement","yPos","_props2","margin","innerWidth","_innerWidth","preserveAspectRatio","viewBox","barWidth","children"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _createReactClass = require('create-react-class');\n\nvar _createReactClass2 = _interopRequireDefault(_createReactClass);\n\nvar _Chart = require('./Chart');\n\nvar _Chart2 = _interopRequireDefault(_Chart);\n\nvar _Bar = require('./Bar');\n\nvar _Bar2 = _interopRequireDefault(_Bar);\n\nvar _DefaultPropsMixin = require('./DefaultPropsMixin');\n\nvar _DefaultPropsMixin2 = _interopRequireDefault(_DefaultPropsMixin);\n\nvar _HeightWidthMixin = require('./HeightWidthMixin');\n\nvar _HeightWidthMixin2 = _interopRequireDefault(_HeightWidthMixin);\n\nvar _ArrayifyMixin = require('./ArrayifyMixin');\n\nvar _ArrayifyMixin2 = _interopRequireDefault(_ArrayifyMixin);\n\nvar _StackAccessorMixin = require('./StackAccessorMixin');\n\nvar _StackAccessorMixin2 = _interopRequireDefault(_StackAccessorMixin);\n\nvar _StackDataMixin = require('./StackDataMixin');\n\nvar _StackDataMixin2 = _interopRequireDefault(_StackDataMixin);\n\nvar _DefaultScalesMixin = require('./DefaultScalesMixin');\n\nvar _DefaultScalesMixin2 = _interopRequireDefault(_DefaultScalesMixin);\n\nvar _TooltipMixin = require('./TooltipMixin');\n\nvar _TooltipMixin2 = _interopRequireDefault(_TooltipMixin);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar array = _propTypes2.default.array,\n    func = _propTypes2.default.func;\n\n// receive array and return a subsampled array of size n\n//\n// a= the array;\n// n= number of sample you want output\n\nvar subSample = function subSample(a, n) {\n    var returnArray = [];\n    var m = a.length;\n    var samplingRatio = m / n;\n\n    //just round down for now in case of comma separated\n    for (var i = 0; i < m;) {\n        returnArray.push(a[Math.floor(i)]);\n        i += samplingRatio;\n    }\n    return returnArray;\n};\n\nvar DataSet = (0, _createReactClass2.default)({\n    displayName: 'DataSet',\n\n    propTypes: {\n        data: array.isRequired,\n        xScale: func.isRequired,\n        yScale: func.isRequired,\n        colorScale: func.isRequired,\n        values: func.isRequired,\n        label: func.isRequired,\n        x: func.isRequired,\n        y: func.isRequired,\n        y0: func.isRequired\n    },\n\n    render: function render() {\n        var _props = this.props,\n            data = _props.data,\n            yScale = _props.yScale,\n            colorScale = _props.colorScale,\n            values = _props.values,\n            label = _props.label,\n            y = _props.y,\n            x0 = _props.x0,\n            onMouseEnter = _props.onMouseEnter,\n            onMouseLeave = _props.onMouseLeave;\n\n\n        var height = yScale(yScale.domain()[0]);\n        var bars = data.map(function (stack) {\n            return values(stack).map(function (e, index) {\n                // maps the range [0,1] to the range [0, yDomain]\n                var yValue = height * y(e);\n                // center vertically to have upper and lower part of the waveform\n                var vy = height / 2 - yValue / 2;\n                //position x(e) * width * 2 because we want equal sapce.\n                var vx = 2 * x0 * index;\n\n                return _react2.default.createElement(_Bar2.default, {\n                    key: label(stack) + '.' + index,\n                    width: x0,\n                    height: yValue,\n                    x: vx,\n                    y: vy,\n                    fill: colorScale(Math.floor(vx)),\n                    data: e,\n                    onMouseEnter: onMouseEnter,\n                    onMouseLeave: onMouseLeave\n                });\n            });\n        });\n\n        return _react2.default.createElement(\n            'g',\n            null,\n            bars\n        );\n    }\n});\n\nvar Waveform = (0, _createReactClass2.default)({\n    displayName: 'Waveform',\n\n    mixins: [_DefaultPropsMixin2.default, _HeightWidthMixin2.default, _ArrayifyMixin2.default, _StackAccessorMixin2.default, _StackDataMixin2.default, _DefaultScalesMixin2.default, _TooltipMixin2.default],\n\n    getDefaultProps: function getDefaultProps() {\n        return {};\n    },\n    _tooltipHtml: function _tooltipHtml(d) {\n        var _ref = [this._xScale, this._yScale],\n            xScale = _ref[0],\n            yScale = _ref[1];\n\n\n        var html = this.props.tooltipHtml(this.props.x(d), this.props.y0(d), this.props.y(d));\n\n        var midPoint = xScale.rangeBand() / 2;\n        var xPos = midPoint + xScale(this.props.x(d));\n\n        var topStack = this._data[this._data.length - 1].values;\n        var topElement = null;\n\n        // TODO: this might not scale if dataset is huge.\n        // consider pre-computing yPos for each X\n        for (var i = 0; i < topStack.length; i++) {\n            if (this.props.x(topStack[i]) === this.props.x(d)) {\n                topElement = topStack[i];\n                break;\n            }\n        }\n        var yPos = yScale(this.props.y0(topElement) + this.props.y(topElement));\n\n        return [html, xPos, yPos];\n    },\n    render: function render() {\n        var _props2 = this.props,\n            height = _props2.height,\n            width = _props2.width,\n            margin = _props2.margin,\n            colorScale = _props2.colorScale,\n            values = _props2.values,\n            label = _props2.label,\n            y = _props2.y,\n            y0 = _props2.y0,\n            x = _props2.x;\n\n\n        var data = this._data;\n        var innerWidth = this._innerWidth;\n        var xScale = this._xScale;\n        var yScale = this._yScale;\n\n        var preserveAspectRatio = 'none';\n        var viewBox = '0 0 ' + width + ' ' + height;\n\n        // there are two options, if the samples are less than the space available\n        // we'll stretch the width of bar and inbetween spaces.\n        // Otherwise we just subSample the dataArray.\n        var barWidth = void 0;\n        if (data[0].values.length > innerWidth / 2) {\n            data[0].values = subSample(data[0].values, innerWidth / 2);\n            barWidth = 1;\n        } else {\n            barWidth = innerWidth / 2 / data[0].values.length;\n        }\n\n        return _react2.default.createElement(\n            'div',\n            null,\n            _react2.default.createElement(\n                _Chart2.default,\n                {\n                    height: height,\n                    width: width,\n                    margin: margin,\n                    viewBox: viewBox,\n                    preserveAspectRatio: preserveAspectRatio\n                },\n                _react2.default.createElement(\n                    DataSet,\n                    {\n                        data: data,\n                        xScale: xScale,\n                        yScale: yScale,\n                        colorScale: colorScale,\n                        label: label,\n                        values: values,\n                        x: x,\n                        y: y,\n                        y0: y0,\n                        x0: barWidth,\n                        onMouseEnter: this.onMouseEnter,\n                        onMouseLeave: this.onMouseLeave\n                    },\n                    this.props.children\n                )\n            )\n        );\n    }\n});\n\nexports.default = Waveform;"]},"metadata":{},"sourceType":"script"}